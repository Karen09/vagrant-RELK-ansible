- name: Add Elasticsearch gpg key
  apt_key: url=https://packages.elastic.co/GPG-KEY-elasticsearch state=present
  tags:
    - install

- name: Add Elasticsearch repo
  apt_repository: repo='deb http://packages.elastic.co/elasticsearch/2.x/debian stable main' state=present
  tags:
    - install

- name: Install Elasticsearch
  apt: name={{ item }} state=latest update_cache=yes
  with_items:
    - curl
    - openjdk-7-jdk
    - elasticsearch
  tags:
    - install

# optional part of installation to configure firewall
- name: iptables roles
  iptables: chain=INPUT protocol=tcp match=tcp destination_port=9200 jump=ACCEPT
  become: yes

- name: iptables roles 2
  iptables: chain=INPUT protocol=tcp match=tcp destination_port=9300 jump=ACCEPT
  become: yes